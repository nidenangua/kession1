webpackJsonp([29],{dw2Y:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("2v7l"),o=i("0xDb"),n=i("COTu"),a={name:"GroupTopic",data:function(){return{topicId:this.$route.query.id,groupId:this.$route.query.team_id,desc:"",loaded:!1,detailLoaded:!1,list:[],content:null,pageCount:null,p:1,topicDetail:{}}},methods:{reply:function(){var t=this;Object(n.i)({team_id:this.groupId,topic_id:this.topicId,content:this.content}).then(function(e){t.$toast(e.result,e.msg),"success"==e.result&&(t.content="",t.getList())})},listSort:function(){this.desc="desc"===this.desc?"":"desc",this.getList()},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.p=e;var i={p:e,maxparpage:10,data:{topic_id:this.topicId}};"desc"===this.desc&&(i.data.sql_order={like_num:"desc"}),this.$showLoading(),Object(n.n)(i).then(function(i){i.list&&i.page&&(t.list=1===e?i.list:t.list.concat(i.list),t.pageCount=i.page.total_pages),t.loaded=!0,t.$hideLoading()})}},mounted:function(){var t=this;window.addEventListener("scroll",function(e){if(Object(o.d)()&&t.p<t.pageCount){var i=t.p+1;t.getList(i)}})},activated:function(){var t=this;document.title="话题详情",this.topicId=this.$route.query.id,this.groupId=this.$route.query.team_id,this.getList(),Object(n.m)({topic_id:this.topicId}).then(function(e){t.topicDetail=e,t.detailLoaded=!0})},components:{TopicItem:s.a}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.loaded&&t.detailLoaded?i("div",[i("topic-item",{attrs:{role:t.topicDetail.loginUser.role,"is-join":t.topicDetail.loginUser.is_join,"group-id":t.groupId,item:t.topicDetail}}),t._v(" "),i("div",{staticClass:"ktj-mt10"},[i("div",{staticClass:"group-tit"},[t._v("全部评论 "),t.list.length?i("span",{class:"desc"===t.desc&&"active",on:{click:t.listSort}},[t._v("按最热排序")]):t._e()]),t._v(" "),t.list.length?i("div",[t._l(t.list,function(e,s){return i("topic-item",{key:s,staticClass:"i < list.length-1 && 'line'",attrs:{type:"reply",role:t.topicDetail.loginUser.role,"group-id":t.groupId,item:e}})}),t._v(" "),null!==t.pageCount&&t.p>=t.pageCount?i("div",{staticClass:"ktj-nomore"},[t._v("\n               没有更多动态了~\n             ")]):i("div",{staticClass:"ktj-nomore"},[t._v("\n                 上拉加载更多\n             ")])],2):t.loaded&&!t.list.length?i("ktj-empty",{staticClass:"ktj-bg-white",attrs:{msg:"暂时相关的评论~",type:"notest"}}):t._e()],1),t._v(" "),i("store-footer"),t._v(" "),i("div",{staticClass:"reply-footer-blank"}),t._v(" "),i("div",{staticClass:"reply-footer"},[i("div",{staticClass:"reply-input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],attrs:{type:"text",placeholder:"发表你的评论吧..."},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),t._v(" "),i("span",{on:{click:t.reply}},[t._v("发送")])])])],1):t._e()},staticRenderFns:[]};var l=i("C7Lr")(a,c,!1,function(t){i("eE8x")},"data-v-57fc8788",null);e.default=l.exports},eE8x:function(t,e){}});